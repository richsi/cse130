Lots of code provided by Mitch during office hours